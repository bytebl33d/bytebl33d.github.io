<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.11.0.818950788999">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.11.0">

    <!-- Primary Meta Tags -->
    <title>Active Directory Home Lab with Proxmox - Part 2</title>
    <meta name="title" content="Active Directory Home Lab with Proxmox - Part 2">
    <meta name="description" content="In this post, we're diving into the setup of Windows virtual machines (VMs) in a Proxmox home lab, with the ultimate goal of building an Active...">

    <!-- Canonical -->
    <link rel="canonical" href="https://bytebl33d.github.io/blog/proxmox-homelab-part2/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://bytebl33d.github.io/blog/proxmox-homelab-part2/">
    <meta property="og:title" content="Active Directory Home Lab with Proxmox - Part 2">
    <meta property="og:description" content="In this post, we're diving into the setup of Windows virtual machines (VMs) in a Proxmox home lab, with the ultimate goal of building an Active...">
    <meta property="og:image" content="https://bytebl33d.github.io/assets/images/headers/ad-banner.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://bytebl33d.github.io/blog/proxmox-homelab-part2/">
    <meta property="twitter:title" content="Active Directory Home Lab with Proxmox - Part 2">
    <meta property="twitter:description" content="In this post, we're diving into the setup of Windows virtual machines (VMs) in a Proxmox home lab, with the ultimate goal of building an Active...">
    <meta property="twitter:image" content="https://bytebl33d.github.io/assets/images/headers/ad-banner.jpg">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="Blog >> Feed" href="https://bytebl33d.github.io/blog/feed.xml">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link href="../../resources/css/retype.css?v=3.11.0.818950788999" rel="stylesheet">

    <script data-cfasync="false" src="../../resources/js/config.js?v=3.11.0.818950788999" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../resources/js/retype.js?v=3.11.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../resources/js/lunr.js?v=3.11.0.818950788999" data-turbo-eval="false" defer></script>
</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../../" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">bytebl33d</span>
                        </a><span id="retype-branding-label" class="inline-flex mt-1 px-2 py-1 ml-4 text-xs font-medium leading-none items-center rounded-md bg-branding-label-bg text-branding-label-text ring-1 ring-branding-label-border ring-inset md:inline-block">Blog</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="../../blog/">Posts</a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://github.com/bytebl33d">GitHub</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-search-placeholder transition-colors duration-200 ease-in bg-search-bg border border-transparent rounded md:text-sm hover:border-search-border-hover focus:outline-none focus:border-search-border-focus" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div class="relative flex mx-auto bg-white max-w-core">
            <div class="md:hidden">
                <!-- Sidebar Skeleton -->
                <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
                
                    <div class="flex items-center h-16 px-6">
                        <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded shadow-none text-sm focus:outline-none focus:border-filter-border-focus" type="text" placeholder="Filter">
                    </div>
                
                    <div class="pl-6 mt-1 mb-4">
                        <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    </div>
                
                    <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </div>
                
                <!-- Sidebar component -->
                <doc-sidebar v-cloak>
                    <template #sidebar-footer>
                        <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
                
                            <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                                <nav>
                                    <ul class="flex flex-wrap justify-center items-center">
                                        <li class="mr-6">
                                            <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="../../blog/">Posts</a>
                                        </li>
                                        <li class="mr-6">
                                            <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://github.com/bytebl33d">GitHub</a>
                                        </li>
                
                                    </ul>
                                </nav>
                            </div>
                
                            <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                                <span class="text-xs whitespace-nowrap">Powered by</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                            </a>
                        </div>
                    </template>
                </doc-sidebar>
            </div>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render page content -->
                <div class="grow min-w-0 px-6">
                    <main class="relative pt-6 pb-16">
                        <div class="retype-markdown" id="retype-content">
                            <!-- Rendered if sidebar right is enabled -->
                            <div id="retype-sidebar-right-toggle"></div>
                            <!-- Page content  -->
<doc-anchor-target id="active-directory-home-lab-with-proxmox---part-2" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#active-directory-home-lab-with-proxmox---part-2">#</doc-anchor-trigger>
        <span>Active Directory Home Lab with Proxmox - Part 2</span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center print:justify-center">
    <div>In&nbsp;</div>
    <div><a href="../../categories/active-directory/">Active-Directory</a>,&nbsp;</div>
    <div><a href="../../categories/homelab/">Homelab</a></div>
    <div class="mx-2">&#9679;</div>
    <div class="flex items-center shrink-0">Published&nbsp;<span>2024-03-27</span></div>
</div>

<p><figure class="content-center">
    <img src="../../assets/images/headers/ad-banner.jpg" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>In this post, we&#x27;re diving into the setup of Windows virtual machines (VMs) in a Proxmox home lab, with the ultimate goal of building an Active Directory (AD) environment. This includes creating a Domain Controller that will also serve as the DHCP server for our AD Lab, and joining a Windows 10 host to the domain. By the end of this guide, you&#x27;ll have a functional AD lab that you can use for learning, experimenting, and testing.</p>
<doc-anchor-target id="what-youll-need">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#what-youll-need">#</doc-anchor-trigger>
        <span>What You&#x27;ll Need</span>
    </h2>
</doc-anchor-target>
<p>To get started with setting up your Windows VMs and creating the AD Lab, make sure you have the following:</p>
<ul>
<li><a href="https://pve.proxmox.com/wiki/Windows_VirtIO_Drivers">Windows VirtIO Drivers</a>: Necessary for better performance and compatibility of Windows VMs in Proxmox.</li>
<li><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2022">Windows Server 2022 ISO</a>: For setting up the Domain Controller.</li>
<li><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise">Windows 10 Enterprise Evaluation ISO</a>: For joining a client machine to the domain.</li>
</ul>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-info"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-info" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Note</h5>
<p>The ISOs typically have a lifespan of 90 to 180 days, but they can often be extended. To be safe, consider taking a snapshot of your VMs right after installation to revert back if needed.</p>
        </div>
    </div>
</div>
<doc-anchor-target id="setting-up-the-ad-lab">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#setting-up-the-ad-lab">#</doc-anchor-trigger>
        <span>Setting Up the AD Lab</span>
    </h2>
</doc-anchor-target>
<p>We&#x27;ll start by uploading the necessary ISOs to our Proxmox server. For this guide, we&#x27;ll create two VMs: a Windows 10 machine and a Domain Controller. Since the setup for both is quite similar, we&#x27;ll focus on the Domain Controller.</p>
<doc-anchor-target id="step-1-create-the-domain-controller-vm">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-1-create-the-domain-controller-vm">#</doc-anchor-trigger>
        <span>Step 1: Create the Domain Controller VM</span>
    </h3>
</doc-anchor-target>
<p>Create a new Virtual Machine and select the Windows Server 2022 ISO image you downloaded. Check the box to add an additional drive for the VirtIO drivers and select the corresponding ISO image.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup.png" alt="DC-Setup" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup</figcaption>
</figure>
</p>
<p>Enable the &quot;Qemu Agent&quot; in the system tab and use the following configuration for the disks.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-1.png" alt="DC-Setup-1" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-1</figcaption>
</figure>
</p>
<p>It&#x27;s recommended to assign at least 8GB of RAM and 2 CPU cores. Skip through the remaining settings, and ensure you select <code v-pre>vmbr3</code> as the network interface bridge (AD LAB).</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-2.png" alt="DC-Setup-2" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-2</figcaption>
</figure>
</p>
<p>Start the VM and press enter to go into the installation process. Begin the installation process by choosing the Windows Server 2022 Standard Evaluation (Desktop Experience) as the operating system. Proceed with the custom installation.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-3.png" alt="DC-Setup-3" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-3</figcaption>
</figure>
</p>
<p>Follow the installer steps until you reach the installation step where you need to select the location to install Windows Server. Click &quot;Load driver&quot; to install the VirtIO drivers for hard disk and the network. Browse to the CD drive where you mounted the VirtIO driver and select folder <code v-pre>vioscsi\2k22\amd64</code> and confirm. Select the &quot;Red Hat VirtIO SCSI pass-through controller&quot; and click next to install it. Repeat this for the <code v-pre>NetKVM\2k22\amd64</code> and <code v-pre>Balloon\2k22\amd64</code> folders.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-3.1.png" alt="DC-Setup-3.1" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-3.1</figcaption>
</figure>
</p>
<p>The first thing to do after the first boot is to rename the computer. Go to <code v-pre>Settings &gt; System &gt; About &gt; Rename This PC</code>. I renamed mine to <code v-pre>DC01</code> and chose to restart later.</p>
<p>Since this machine will serve as the DHCP server, it needs a static IP. Go to <code v-pre>Control Panel &gt; Network and Internet &gt; Network and Sharing Center &gt; Change Adapter Settings</code>, and configure the network interface with a private IP address (e.g., <code v-pre>172.16.200.100</code>). Set the DNS server to <code v-pre>127.0.0.1</code>, since the DC will also be a DNS server.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-4.png" alt="DC-Setup-4" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-4</figcaption>
</figure>
</p>
<doc-anchor-target id="step-2-install-active-directory-domain-services">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-2-install-active-directory-domain-services">#</doc-anchor-trigger>
        <span>Step 2: Install Active Directory Domain Services</span>
    </h3>
</doc-anchor-target>
<p>Open Server Manager and select <code v-pre>Add roles and features</code>. Accept the default settings until you&#x27;re prompted with the <code v-pre>Server Roles</code> section. Select <code v-pre>Active Directory Domain Services</code> and add the necessary features. Once it has installed successfully, select <code v-pre>Close</code>. I also installed the DNS and DHCP Server Features together with Active Directory Certificate Services, but this is optional.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-ad-services.gif" alt="DC-Setup-ad-services" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-ad-services</figcaption>
</figure>
</p>
<p>The next step is to promote the server to a domain controller. You will need to have the domain name you want to use in the next step. I will choose the domain name of <code v-pre>cicada.local</code>. To promote the server to a domain controller, click on the notification icon on the top section of the Server Manager program. Then select <code v-pre>Promote this server to a domain controller</code>. Select <code v-pre>Add a new forest</code> as this is a newly created AD environment. Enter the domain name in the root domain name field. Once the Windows Server has rebooted, you will see the login screen show the domain entered in the previous step.</p>
<doc-anchor-target id="step-3-create-a-domain-admin-account">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-3-create-a-domain-admin-account">#</doc-anchor-trigger>
        <span>Step 3: Create a Domain Admin Account</span>
    </h3>
</doc-anchor-target>
<p>After logging in, open <code v-pre>Active Directory Users and Computers</code>. As I like to keep things organized, I will create a new group for all the user accounts. Right click on your domain and select <code v-pre>New &gt; Organizational Unit</code> and name it <code v-pre>Groups</code>. Move all group related objects from the <code v-pre>Users</code> to the <code v-pre>Groups</code> folder. Right click on the <code v-pre>Users</code> folder and select <code v-pre>New &gt; User</code>.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-5.png" alt="DC-Setup-5" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-5</figcaption>
</figure>
</p>
<p>Fill in the user details and set a password for the account. Disable the option <code v-pre>User must change password at next logon</code> and check the <code v-pre>Password never expires</code>. In an organization, the former should be checked so that the end user can set their own password.</p>
<p>Now we need to add the newly created account to the <code v-pre>Domain Admin</code> group. This can be done right clicking the newly created user and selecting Properties. Select the <code v-pre>Member of &gt; Add</code>. Under the <code v-pre>Enter the object names to select</code> section, click on the <code v-pre>Advanced</code> button. Then click <code v-pre>Find now &gt; Domain Admins</code> and click <code v-pre>OK</code>.</p>
<p>We can then logout of the Administrator account and login with our newly created domain account. Whenever we create a new user account, they are able to login with their credentials on any domain joined host.</p>
<doc-anchor-target id="step-4-configure-the-dhcp-server">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-4-configure-the-dhcp-server">#</doc-anchor-trigger>
        <span>Step 4: Configure the DHCP Server</span>
    </h3>
</doc-anchor-target>
<p>Go to <code v-pre>Server Manager &gt; Add roles and Features</code>, select DHCP Server, and complete the installation. Once done, complete the DHCP configuration through the notifications in Server Manager.</p>
<p>We then have to configure a DHCP scope. To do so, go to <code v-pre>Server Manager</code> once again. Then select <code v-pre>Tools &gt; DHCP</code>. Expand the available options and then right click on IPv4 to create an IPv4 Scope. Set a name for the scope and give it a description if you wish to do so. Select <code v-pre>Next</code> and set the range to be somewhere inside the <code v-pre>172.16.200.1/24</code> network. I choose the starting IP to be <code v-pre>172.16.200.11</code> to give me some room in case I want to add some static IPs later. You can also exclude some IP addresses if you want to.</p>
<p><figure class="content-center">
    <img src="../../assets/images/homelab/dc-setup-6.png" alt="DC-Setup-6" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">DC-Setup-6</figcaption>
</figure>
</p>
<p>When prompted if you want to configure DHCP options for this scope now, choose <code v-pre>Yes</code>, then select <code v-pre>Next</code>. You will then be prompted to select the IP address for the default gateway. The IP address we gave our default gateway was <code v-pre>172.16.200.1</code>. Enter that and click on Add. Then select Next.</p>
<doc-anchor-target id="add-windows-10-vm-to-domain">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#add-windows-10-vm-to-domain">#</doc-anchor-trigger>
        <span>Add Windows 10 VM to Domain</span>
    </h3>
</doc-anchor-target>
<p>Go through the initial setup wizard and login with the local account you created. The next step is to join the Windows 10 VM to the domain. To do so, open the <code v-pre>Settings</code> program and go to <code v-pre>Accounts &gt; Access work or school &gt; Connect</code>. In the pop out window, select the option <code v-pre>Join this device to a local Active Directory domain</code>. Enter the domain name we used to configure our Active Directory forest (I used cicada.local). You will then be prompted for a login.</p>
<p>Windows 10 will restart after entering the credentials. After rebooting, you can now login to the domain by selecting Other User in the lower left corner.</p>
<doc-anchor-target id="conclusion">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#conclusion">#</doc-anchor-trigger>
        <span>Conclusion</span>
    </h2>
</doc-anchor-target>
<p>Congratulations! You now have a fully functioning Active Directory home lab. With your Domain Controller and Windows 10 VM set up, you’re ready to explore, experiment, and even simulate attacks to understand how AD environments operate and how they can be secured or compromised. In the next part, we’ll delve into common misconfigurations in Windows and Active Directory and explore how attackers might exploit them. Stay tuned!</p>

                            
                            <!-- Required only on API pages -->
                            <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                        </div>
                        <footer id="retype-content-footer" class="clear-both">
                        
                            <nav id="retype-nextprev" class="print:hidden flex mt-14">
                                <div class="w-1/2">
                                    <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../blog/proxmox-homelab-part3/">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        <span>
                                            <span class="block text-xs font-normal text-base-text-muted">Newer</span>
                                            <span class="block mt-1">Active Directory Home Lab with Proxmox - Part 3</span>
                                        </span>
                                    </a>
                                </div>
                        
                                <div class="w-1/2">
                                    <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../blog/proxmox-homelab-part1/">
                                        <span>
                                            <span class="block text-xs font-normal text-right text-base-text-muted">Older</span>
                                            <span class="block mt-1">Active Directory Home Lab with Proxmox - Part 1</span>
                                        </span>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                    </a>
                                </div>
                            </nav>
                        </footer>
                    </main>
                </div>

            </div>
        </div>
    
        <div class="border-t dark:border-base-border">
            <div class="max-w-core mx-auto px-6 py-6">
                <footer>
                    <div class="flex flex-wrap items-center justify-between">
                        <div class="pt-3">
                            <ul class="flex flex-wrap items-center text-sm">
                            </ul>
                        </div>
                        <div id="retype-copyright" class="print:justify-center pt-3 text-footer-text font-footer-link-weight text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                    </div>
                
                    <div class="flex justify-center">
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </footer>
            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Active Directory Home Lab with Proxmox - Part 2", level: 2, icon: "file", hasPrism: false, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
